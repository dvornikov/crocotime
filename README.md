Есть баги и неточности.

Структура базы в site.sql